<Page x:Class="Invoice.PaymentPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:Invoice"
      xmlns:vm="clr-namespace:Invoice.ViewModels"
      xmlns:conv="clr-namespace:Invoice.Converters"
      xmlns:ui="http://schemas.modernwpf.com/2019"
      mc:Ignorable="d"
      d:Background="White"
      d:DesignHeight="650"
      d:DesignWidth="800"
      FontFamily="Biz UDGothic"
      Title="Payment">
    <Page.Resources>
        <conv:InvoiceIdToSlipNumberConverter x:Key="InvoiceIdToSlipNumberConverter" />
        <CollectionViewSource Source="{Binding SettingsVM.PaymentMethodClassList}"
                              x:Key="PaymentMethodWhithoutNewPlaceholder" />
  
    </Page.Resources>
    <Grid x:Name="PageRootGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="155" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid x:Name="NavigationGrid"
              Grid.Row="0"
              Background="#4CAF50">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Label FontSize="32px"
                   FontWeight="Bold"
                   Foreground="White"
                   HorizontalAlignment="Center"
                   Margin="0,40,0,25"
                   FontFamily="BIZ UDGothic">入金管理</Label>
            <StackPanel Grid.Row="1"
                        Height="30"
                        VerticalAlignment="Top"
                        HorizontalAlignment="Center"
                        Orientation="Horizontal"
                        Background="Transparent">
                <StackPanel.Resources>
                    <Style TargetType="Label">
                        <Setter Property="Foreground"
                                Value="White" />
                        <Setter Property="Margin"
                                Value="7,0" />
                        <Setter Property="VerticalAlignment"
                                Value="Center" />
                        <Setter Property="Cursor"
                                Value="Hand" />
                        <Setter Property="HorizontalContentAlignment"
                                Value="Center" />
                        <Setter Property="FontSize"
                                Value="16px" />
                    </Style>
                </StackPanel.Resources>
                <Label x:Name="DashBoardLabel"
                       MouseLeftButtonUp="Label_MouseLeftButtonUp">ダッシュボード</Label>
                <Label x:Name="CustomerLabel"
                       MouseLeftButtonUp="Label_MouseLeftButtonUp">利用者管理</Label>
                <Label x:Name="InvoiceLabel"
                       MouseLeftButtonUp="Label_MouseLeftButtonUp">請求書管理</Label>
                <Label x:Name="PaymentLabel"
                       MouseLeftButtonUp="Label_MouseLeftButtonUp">入金管理</Label>
                <Label x:Name="SettingsLabel"
                       MouseLeftButtonUp="Label_MouseLeftButtonUp">設定</Label>
            </StackPanel>
        </Grid>
        <Grid x:Name="PaymentPageContentsGrid"
              Grid.Row="1"
              Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="50" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0"
                  Width="700"
                  MaxWidth="700"
                  MinWidth="700"
                  HorizontalAlignment="Stretch"
                  VerticalAlignment="Top">
                <Label Content="入金一覧"
                       FontSize="24"
                       FontWeight="Bold"
                       Margin="0,20" />
                <Grid HorizontalAlignment="Right"
                      VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <!--<TextBlock Grid.Column="0"
                               FontSize="16"
                               FontWeight="Bold"
                               Text="全期間表示"
                               VerticalAlignment="Center" />-->
                    <ui:ToggleSwitch Grid.Column="1"
                                     x:Name="ShowAllPayment"
                                     Margin="0,0,0,0"
                                     Width="120"
                                     OnContent="指定期間"
                                     OffContent="全期間"
                                     Header="表示期間"
                                     FontWeight="Bold"
                                     Toggled="ShowAllPayment_Toggled"
                                     />

                    <ui:NumberBox Grid.Column="2"
                                  x:Name="DateBox"
                                  Grid.Row="0"
                                  Padding="0,0,0,0"
                                  TextAlignment="Center"
                                  SpinButtonPlacementMode="Inline"
                                  VerticalAlignment="Center"
                                  FontSize="18"
                                  Value="300"
                                  Tag="0"
                                  IsEnabled="{Binding ElementName=ShowAllPayment,Path=IsOn}"
                                  Maximum="6000"
                                  Minimum="-6000"
                                  Width="210"
                                  HorizontalContentAlignment="Center"
                                  VerticalContentAlignment="Center"
                                  ValueChanged="DateBox_ValueChanged">
                        <ui:NumberBox.Resources>
                            <Style TargetType="TextBox"
                                   BasedOn="{StaticResource DefaultTextBoxStyle}">
                                <Style.Triggers>
                                    <Trigger Property="Name"
                                             Value="InputBox">
                                        <Setter Property="Foreground"
                                                Value="Transparent" />

                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ui:NumberBox.Resources>
                    </ui:NumberBox>
                    <TextBlock x:Name="DateTextBlock"
                               Margin="2"
                               Width="140"
                               HorizontalAlignment="Left"
                               Grid.Column="2"
                               Height="{Binding ElementName=DateBox,Path=ActualHeight}"
                               Background="Transparent"
                               VerticalAlignment="Bottom"
                               TextAlignment="Center"
                               FontSize="18"
                               FontWeight="Bold"

                               FontFamily="{StaticResource ContentControlThemeFontFamily}"
                               Text="{Binding PaymentVM.ViewDate}">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=ShowAllPayment,Path=IsOn}"
                                             Value="False">
                                        <Setter Property="Foreground"
                                                Value="Gray" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <!--Toggled="ShowAllCustomer_Toggled"-->
                </Grid>

            </Grid>
            <DataGrid x:Name="PaymentListDataGrid"
                      Grid.Row="2"
                      MouseDoubleClick="PaymentListDataGrid_MouseDoubleClick"
                      CanUserAddRows="False"
                      CanUserResizeColumns="False"
                      AutoGenerateColumns="False"
                      VerticalAlignment="Stretch"
                      VerticalScrollBarVisibility="Auto"
                      SelectionUnit="FullRow"
                      ItemsSource="{Binding PaymentVM.PaymentListViewSource.View}"
                      AlternatingRowBackground="#0C000000"
                      ColumnHeaderHeight="28"
                      CanUserDeleteRows="False"
                      RowHeaderWidth="0">
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell"
                           BasedOn="{StaticResource DefaultDataGridCellStyle}">
                        <Setter Property="OverridesDefaultStyle"
                                Value="True" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <ui:DataGridCellPresenter Background="{TemplateBinding Background}"
                                                              CurrencyVisualBrush="{DynamicResource DataGridCurrencyVisualPrimaryBrush}"
                                                              CurrencyVisualThickness="0"
                                                              FocusVisualPrimaryBrush="{DynamicResource DataGridCellFocusVisualPrimaryBrush}"
                                                              FocusVisualPrimaryThickness="0"
                                                              FocusVisualSecondaryBrush="{DynamicResource DataGridCellFocusVisualSecondaryBrush}"
                                                              FocusVisualSecondaryThickness="0"
                                                              IsCurrencyVisualVisible="{TemplateBinding IsSelected}"
                                                              IsFocusVisualVisible="{TemplateBinding IsKeyboardFocusWithin}"
                                                              MinHeight="{TemplateBinding MinHeight}"
                                                              SnapsToDevicePixels="True" />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.CellStyle>

                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="{x:Type DataGridColumnHeader}">
                        <Setter Property="FontSize"
                                Value="15" />
                        <Setter Property="HorizontalContentAlignment"
                                Value="Center" />
                        <Setter Property="Padding"
                                Value="0" />
                        <Setter Property="Margin"
                                Value="0" />
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.Columns>
                    <DataGridTemplateColumn Width="30">
                        <DataGridTemplateColumn.Header>
                            <CheckBox x:Name="SelectAllCheckBox"
                                      Checked="SelectAllCheckBox_Checked"
                                      Unchecked="SelectAllCheckBox_Unchecked" />
                        </DataGridTemplateColumn.Header>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox x:Name="GridRowCheckBox"
                                          IsChecked="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected, Mode=TwoWay}"
                                          PreviewMouseLeftButtonDown="GridRowCheckBox_PreviewMouseLeftButtonDown"
                                          Width="20">
                                    <CheckBox.Resources>
                                        <Style TargetType="CheckBox"
                                               BasedOn="{StaticResource DefaultCheckBoxStyle}">
                                            <Setter Property="HorizontalAlignment"
                                                    Value="Center" />
                                            <Setter Property="Width"
                                                    Value="20" />
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <TextBlock Width="0"
                                                               Visibility="Collapsed" />
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                        <Style TargetType="Grid">
                                            <Setter Property="Width"
                                                    Value="20" />
                                        </Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Width"
                                                    Value="20" />
                                        </Style>
                                    </CheckBox.Resources>
                                </CheckBox>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>

                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="№"
                                            Width="90*">
                        <DataGridTemplateColumn.CellTemplate>

                            <DataTemplate>
                                <TextBlock HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Padding="0,0,5,0"
                                           Text="{Binding SlipNumber}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>

                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="請求№"
                                            Width="90*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Padding="0,0,5,0"
                                           Text="{Binding InvoiceId, Converter={StaticResource InvoiceIdToSlipNumberConverter}}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="宛先"
                                            Width="100*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>

                                <TextBlock HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Text="{Binding CustomerName}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="件名"
                                            Width="200*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Padding="5,0,0,0"
                                           Text="{Binding Subject}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="入金額"
                                            Width="100*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock HorizontalAlignment="Right"
                                           VerticalAlignment="Center"
                                           Padding="0,0,5,0"
                                           Text="{Binding PaymentAmount,StringFormat={}\\{0:N0}-}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="入金日"
                                            Width="130*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Text="{Binding PaymentDateString}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>


                </DataGrid.Columns>

            </DataGrid>
            <StackPanel Grid.Row="3"
                        Width="600"
                        MaxWidth="600"
                        MinWidth="600"
                        Margin="0,0,0,0"
                        Orientation="Horizontal">
                <Button x:Name="AddPaymentButton"
                        Content="入金登録"
                        Width="130"
                        Height="30"
                        Margin="0,10,0,10"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Click="AddPaymentButton_Click" />
                <Button x:Name="EditPaymentButton"
                        Content="入金情報編集"
                        Width="130"
                        Height="30"
                        Margin="10,10,0,10"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Click="EditPaymentButton_Click" />
                <Button x:Name="CreateReceiptButton"
                        Content="領収書PDF作成"
                        Width="130"
                        Height="30"
                        Margin="10,10,0,10"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Click="CreateReceiptButton_Click" />
                <Button x:Name="DeletePaymentButton"
                        Content="削除"
                        Width="130"
                        Height="30"
                        Margin="10,10,0,10"
                        Click="DeletePaymentButton_Click" />

            </StackPanel>
        </Grid>
        <Border x:Name="PaymentDetailPane"
                Grid.Row="1"
                Background="White"
                Height="470"
                Padding="0"
                VerticalAlignment="Bottom"
                RenderTransformOrigin="0.5,1">
            <Border.RenderTransform>
                <TranslateTransform x:Name="PaneTransform"
                                    Y="{Binding RelativeSource={RelativeSource AncestorType=Border},Path=Height}" />
            </Border.RenderTransform>
            <Grid x:Name="DetailPaneRootGrid"
                  Margin="10,5,10,10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid x:Name="DetailPaneRootGrid_Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Label Grid.Column="0"
                           d:Content="新規入金作成"
                           FontSize="24"
                           Height="43"
                           FontWeight="Bold"
                           Margin="0,0,30,0">
                        <Label.Content>
                            <TextBlock Text="{Binding PaymentVM.PaneTitle}" />
                        </Label.Content>
                    </Label>
                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0"
                                   Text="入金日"
                                   Margin="0,2" />
                        <DatePicker Grid.Row="1"
                                    x:Name="PaymentDate"
                                    BorderThickness="0"
                                    Background="#0C000000"
                                    FontSize="17"
                                    SelectedDateFormat="Short"
                                    Padding="0"
                                    d:SelectedDate="2025/1/31"
                                    HorizontalContentAlignment="Center"
                                    InputMethod.IsInputMethodEnabled="False"
                                    SelectedDateChanged="PaymentDate_SelectedDateChanged"
                                    SelectedDate="{Binding PaymentVM.PaymentDetailData.PaymentDate,Mode=TwoWay}"
                                    Width="180"
                                    Margin="0,0,30,0">

                        </DatePicker>
                    </Grid>
                    <Grid Grid.Column="2"
                          Margin="0,0,0,0"
                          HorizontalAlignment="Stretch">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0"
                                   Margin="0,2"
                                   Background="Transparent"
                                   Text="入金方法" />
                        <ComboBox x:Name="PaymentMethodComboBox"
                                  ItemsSource="{Binding Source={StaticResource PaymentMethodWhithoutNewPlaceholder}}"
                                  DisplayMemberPath="MethodName"
                                  SelectedValuePath="PaymentMethodId"
                                  SelectedValue="{Binding PaymentMethodId,Mode=TwoWay}"
                                  FontSize="20"
                                  Grid.Row="1"
                                  BorderThickness="0"
                                  Background="#0C000000"
                                  Width="160"
                                  d:SelectedIndex="0" />
                    </Grid>
                    <Grid Grid.Column="4"
                          HorizontalAlignment="Right"
                          VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ui:ToggleSwitch Grid.Column="1"
                                         x:Name="PaymentForInvoiceSwitch"
                                         Margin="10,0,0,0"
                                         IsOn="True"
                                         Header="請求情報から選択"
                                         OnContent="する"
                                         OffContent="しない"
                                         Toggled="PaymentForInvoiceSwitch_Toggled" />

                    </Grid>
                </Grid>
                <Grid x:Name="DetailPaneRootGrid_2nd"
                      Margin="0,5,0,5"
                      HorizontalAlignment="Stretch"
                      Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid HorizontalAlignment="Left"
                          VerticalAlignment="Bottom"
                          Grid.Column="0"
                          Margin="0,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0"
                                   Text="宛先"
                                   Margin="0,0,0,2" />
                        <ComboBox x:Name="CustomerNameComboBox"
                                  Grid.Row="1"
                                  ItemsSource="{Binding CustomerVM.CustomerClassList}"
                                  DisplayMemberPath="CustomerName"
                                  SelectedValuePath="CustomerId"
                                  SelectedValue="{Binding PaymentDetailData.CustomerId,Mode=TwoWay}"
                                  SelectionChanged="CustomerNameComboBox_SelectionChanged"
                                  Margin="0,0,30,0"
                                  Width="168"
                                  FontSize="20"
                                  BorderThickness="0"
                                  Background="#0C000000"
                                  InputMethod.PreferredImeState="On"
                                  InputMethod.PreferredImeConversionMode="FullShape,Native"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Top" />
                    </Grid>
                    <Grid HorizontalAlignment="Right"
                          VerticalAlignment="Bottom"
                          Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0"
                                   Text="件名"
                                   Margin="0,0,0,2" />
                        <TextBox Margin="0,0,0,0"
                                 Grid.Row="1"
                                 FontSize="20"
                                 x:Name="InvoiceSubject"
                                 BorderThickness="0"
                                 Background="#FFF3F3F3"
                                 InputMethod.IsInputMethodEnabled="True"
                                 InputMethod.PreferredImeConversionMode="FullShape,Native"
                                 HorizontalContentAlignment="Left"
                                 d:Text="利用料2025年1月分"
                                 Text="{Binding PaymentVM.PaymentDetailData.Subject,Mode=TwoWay}"
                                 Width="390"
                                 VerticalAlignment="Top" />
                    </Grid>
                    <Grid Grid.Column="3"
                          Margin="0,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="37" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0"
                                   FontWeight="Bold"
                                   Text="受領額" />
                        <Rectangle Grid.Row="1"
                                   RadiusX="2"
                                   RadiusY="2"
                                   Fill="#0C000000"
                                   Margin="0,0,0,0" />
                        <TextBox x:Name="InvoiceAmmountTextBlock"
                                 Grid.Row="1"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 TextAlignment="Right"
                                 d:Text="￥6,7000"
                                 FontSize="25"
                                 Padding="0,0,5,0"
                                 VerticalAlignment="Center"
                                 FontWeight="Bold"
                                 Text="{Binding PaymentVM.PaymentDetailData.PaymentAmount,StringFormat={}\\{0:N0}-,Mode=TwoWay}"
                                 Width="160"
                                 InputMethod.IsInputMethodEnabled="False" />
                    </Grid>

                </Grid>
                <Border x:Name="InvoiceForPaymentBorder"
                        Grid.Row="2"
                        BorderThickness="0,5,0,0"
                        BorderBrush="#44000000">
                    <Grid x:Name="InvoiceForPaymentGrid">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <Grid Margin="0,5"
                              Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid HorizontalAlignment="Left"
                                  VerticalAlignment="Bottom"
                                  Grid.Column="0"
                                  Margin="0,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0"
                                           Text="宛先"
                                           Margin="0,0,0,2" />
                                <ComboBox x:Name="CustomerNameFilterComboBox"
                                          Grid.Row="1"
                                          ItemsSource="{Binding CustomerVM.CustomerClassList}"
                                          DisplayMemberPath="CustomerName"
                                          SelectedValuePath="CustomerId"
                                          SelectedValue="{Binding PaymentDetailData.CustomerId,Mode=TwoWay}"
                                          SelectionChanged="CustomerNameFilterComboBox_SelectionChanged"
                                          Margin="0,0,30,0"
                                          Width="168"
                                          FontSize="20"
                                          BorderThickness="0"
                                          Background="#0C000000"
                                          InputMethod.PreferredImeState="On"
                                          InputMethod.PreferredImeConversionMode="FullShape,Native"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Top" />
                            </Grid>
                            <ui:ToggleSwitch Grid.Column="1"
                                             x:Name="DateFilterSwitch"
                                             Header="期間フィルタ"
                                             IsOn="True"
                                             OnContent="する"
                                             OffContent="しない"
                                             Margin="0,-2"
                                             Width="100"
                                             Toggled="DateFilterSwitch_Toggled" />
                            <ui:NumberBox Grid.Column="2"
                                          x:Name="FilterDateBox"
                                          Grid.Row="0"
                                          Padding="0,0,0,0"
                                          TextAlignment="Center"
                                          SpinButtonPlacementMode="Inline"
                                          VerticalAlignment="Bottom"
                                          FontSize="18"
                                          Value="300"
                                          Tag="0"
                                          IsEnabled="{Binding ElementName=DateFilterSwitch,Path=IsOn}"
                                          Maximum="6000"
                                          Minimum="-6000"
                                          Width="210"
                                          HorizontalContentAlignment="Center"
                                          VerticalContentAlignment="Center"
                                          ValueChanged="FilterDateBox_ValueChanged">
                                <ui:NumberBox.Resources>
                                    <Style TargetType="TextBox"
                                           BasedOn="{StaticResource DefaultTextBoxStyle}">
                                        <Style.Triggers>
                                            <Trigger Property="Name"
                                                     Value="InputBox">
                                                <Setter Property="Foreground"
                                                        Value="Transparent" />

                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ui:NumberBox.Resources>
                                <ui:NumberBox.Header>
                                    <TextBlock Text="請求月"
                                               FontSize="13"
                                               Margin="0,-5" />

                                </ui:NumberBox.Header>
                            </ui:NumberBox>
                            <TextBlock Grid.Column="2"
                                       x:Name="FilterDateTextBlock"
                                       Height="31"
                                       Width="140"
                                       HorizontalAlignment="Left"
                                       Background="Transparent"
                                       VerticalAlignment="Bottom"
                                       TextAlignment="Center"
                                       IsEnabled="{Binding ElementName=DateFilterSwitch,Path=IsOn}"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       FontFamily="{StaticResource ContentControlThemeFontFamily}"
                                       Text="{Binding PaymentVM.InvoiceViewDate}">
                                <TextBlock.Resources>
                                    <Style BasedOn="{StaticResource {x:Type TextBlock}}"
                                           TargetType="TextBlock">
                                        <Style.Triggers>
                                            <Trigger Property="IsEnabled"
                                                     Value="False">
                                                <Setter Property="Foreground"
                                                        Value="Gray" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Resources>
                            </TextBlock>
                            <!--Toggled="ShowAllCustomer_Toggled"-->
                            <Grid Margin="10,0,0,0"
                                  Grid.Column="3"
                                  VerticalAlignment="Bottom">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="32" />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0"
                                           Margin="0,0,0,2"
                                           Background="Transparent"
                                           Text="ステータスフィルタ"
                                           VerticalAlignment="Bottom" />
                                <ComboBox x:Name="StatusComboBox"
                                          Grid.Row="1"
                                          BorderThickness="0"
                                          Background="#0C000000"
                                          Width="150"
                                          SelectedIndex="0"
                                          ItemsSource="{Binding InvoiceVM.InvoiceStatusClassList}"
                                          DisplayMemberPath="InvoiceStatus"
                                          SelectedValuePath="InvoiceStatusId"
                                          SelectedValue="{Binding PaymentDetailData.InvoiceStatusFilterValue}"
                                          SelectionChanged="StatusComboBox_SelectionChanged"
                                          Padding="12,0,0,0"
                                          FontSize="20">
                                    <ComboBox.Resources>
                                        <Style TargetType="ComboBoxItem">
                                            <Setter Property="Padding"
                                                    Value="0" />
                                        </Style>
                                    </ComboBox.Resources>
                                </ComboBox>
                            </Grid>
                            <Button x:Name="FilterClearButton"
                                    Grid.Column="4"
                                    Content="フィルタクリア"
                                    Width="100"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Bottom"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Click="FilterClearButton_Click"
                                    />

                        </Grid>
                        <DataGrid x:Name="InvoiceListDataGrid"
                                  Grid.Row="1"
                                  SelectionChanged="InvoiceListDataGrid_SelectionChanged"
                                  CanUserAddRows="False"
                                  CanUserResizeColumns="False"
                                  AutoGenerateColumns="False"
                                  VerticalAlignment="Stretch"
                                  Height="233"
                                  VerticalScrollBarVisibility="Auto"
                                  SelectionUnit="FullRow"
                                  SelectionMode="Single"
                                  ItemsSource="{Binding PaymentVM.InvoiceListForPayment.View}"
                                  AlternatingRowBackground="#0C000000"
                                  ColumnHeaderHeight="28"
                                  CanUserDeleteRows="False"
                                  RowHeaderWidth="0">
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell"
                                       BasedOn="{StaticResource DefaultDataGridCellStyle}">
                                    <Setter Property="OverridesDefaultStyle"
                                            Value="True" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="DataGridCell">
                                                <ui:DataGridCellPresenter Background="{TemplateBinding Background}"
                                                                          CurrencyVisualBrush="{DynamicResource DataGridCurrencyVisualPrimaryBrush}"
                                                                          CurrencyVisualThickness="0"
                                                                          FocusVisualPrimaryBrush="{DynamicResource DataGridCellFocusVisualPrimaryBrush}"
                                                                          FocusVisualPrimaryThickness="0"
                                                                          FocusVisualSecondaryBrush="{DynamicResource DataGridCellFocusVisualSecondaryBrush}"
                                                                          FocusVisualSecondaryThickness="0"
                                                                          IsCurrencyVisualVisible="{TemplateBinding IsSelected}"
                                                                          IsFocusVisualVisible="{TemplateBinding IsKeyboardFocusWithin}"
                                                                          MinHeight="{TemplateBinding MinHeight}"
                                                                          SnapsToDevicePixels="True" />
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGrid.CellStyle>

                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="{x:Type DataGridColumnHeader}">
                                    <Setter Property="FontSize"
                                            Value="15" />
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Center" />
                                    <Setter Property="Padding"
                                            Value="0" />
                                    <Setter Property="Margin"
                                            Value="0" />
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Width="30">
                                    <DataGridTemplateColumn.Header>
                                        <CheckBox x:Name="SelectAllInvoiceCheckBox"
                                                  Checked="SelectAllCheckBox_Checked"
                                                  Unchecked="SelectAllCheckBox_Unchecked" />
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox x:Name="GridRowCheckBox"
                                                      IsChecked="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected, Mode=TwoWay}"
                                                      PreviewMouseLeftButtonDown="GridRowCheckBox_PreviewMouseLeftButtonDown"
                                                      Width="20">
                                                <!--Checked="InvoiceCheckBox_Checked"
                                    Unchecked="InvoiceCheckBox_Unchecked"-->
                                                <CheckBox.Resources>
                                                    <Style TargetType="CheckBox"
                                                           BasedOn="{StaticResource DefaultCheckBoxStyle}">
                                                        <Setter Property="HorizontalAlignment"
                                                                Value="Center" />
                                                        <Setter Property="Width"
                                                                Value="20" />
                                                        <Setter Property="Content">
                                                            <Setter.Value>
                                                                <TextBlock Width="0"
                                                                           Visibility="Collapsed" />
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width"
                                                                Value="20" />
                                                    </Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Width"
                                                                Value="20" />
                                                    </Style>
                                                </CheckBox.Resources>
                                            </CheckBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>

                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="No."
                                                        Width="90*">
                                    <DataGridTemplateColumn.CellTemplate>

                                        <DataTemplate>
                                            <TextBlock HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Padding="0,0,5,0"
                                                       Text="{Binding SlipNumber}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>

                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Header="宛先"
                                                        Width="100*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>

                                            <TextBlock HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Text="{Binding CustomerName}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Header="件名"
                                                        Width="200*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock HorizontalAlignment="Left"
                                                       VerticalAlignment="Center"
                                                       Padding="5,0,0,0"
                                                       Text="{Binding Subject}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Header="請求金額"
                                                        Width="100*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Padding="0,0,5,0"
                                                       Text="{Binding Total,StringFormat={}{0:N0}}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Header="発行日"
                                                        Width="130*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Text="{Binding IssueDateString}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Header="ステータス"
                                                        Width="100*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Padding="0,0,5,0"
                                                       Text="{Binding InvoiceStatus}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                            </DataGrid.Columns>

                        </DataGrid>
                    </Grid>
                </Border>
                <Grid x:Name="DetailPaneRootGrid_4th"
                      Grid.Row="4"
                      HorizontalAlignment="Stretch"
                      Margin="0,2,0,0"
                      VerticalAlignment="Bottom">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="3"
                            x:Name="SavePaymentButton"
                            Margin="2,0"
                            d:Content="保存"
                            Content="{Binding PaymentVM.SaveButtonText}"
                            Width="90"
                            VerticalAlignment="Bottom"
                            Click="SavePaymentButton_Click"
                            Height="32" />
                    <Button Grid.Column="4"
                            x:Name="PaymentCancelButton"
                            Margin="2,0"
                            Content="キャンセル"
                            Width="90"
                            VerticalAlignment="Bottom"
                            Click="PaymentCancelButton_Click"
                            Height="32" />

                </Grid>
            </Grid>
        </Border>
    </Grid>
</Page>
